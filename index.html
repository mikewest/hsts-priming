<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>HSTS Priming</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
<style data-fill-with="stylesheet">/* This section copied from the W3C's ED styles. */

	body {
		color: black;
		font-family: sans-serif;
		margin: 0 auto;
		max-width: 50em;
		padding: 2em 1em 2em 70px;
	}
	:link { color: #00C; background: transparent }
	:visited { color: #609; background: transparent }
	a[href]:active { color: #C00; background: transparent }
	a[href]:hover { background: #ffa }

	a[href] img { border-style: none }

	h1, h2, h3, h4, h5, h6 { text-align: left }
	h1, h2, h3 { color: #005A9C; }
	h1 { font: 170% sans-serif }
	h2 { font: 140% sans-serif }
	h3 { font: 120% sans-serif }
	h4 { font: bold 100% sans-serif }
	h5 { font: italic 100% sans-serif }
	h6 { font: small-caps 100% sans-serif }

	.hide { display: none }

	div.head { margin-bottom: 1em }
	div.head h1 { margin-top: 2em; clear: both }
	div.head table { margin-left: 2em; margin-top: 2em }

	p.copyright { font-size: small }
	p.copyright small { font-size: small }

	pre { margin-left: 2em }
	dt { font-weight: bold }

	ul.toc, ol.toc {
		list-style: none;
	}

/* The rest copied from the CSSWG's default.css */

	body {
		counter-reset: exampleno figure issue;
		max-width: 50em;
		margin: 0 auto !important;
		line-height: 1.5;
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
	}

	h2, h3, h5, h6 {
		margin-top: 3em;
	}
	h4 {
		 margin-top: 4em;
	}

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle + h2 {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/
	/* <hr> used to separate TMI into the second half of a section              */
	hr:not([title]) {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	hr:not([title])::before {
		content: "\1F411\2003\2003\1F411\2003\2003\1F411";
	}
	/* note: <hr> with title separates document header from contents */

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}
	dd     > p:first-child,
	li     > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}
	li {
		margin: 0.25em 2em 0.5em 0;
		padding-left: 0;
	}

	dl dd {
		margin: 0 0 1em 2em;
	}
	.head dd {
		margin-bottom: 0;
	}

	/* Style for algorithms */
	ol.algorithm ol {
	 border-left: 1px solid #90b8de;
	 margin-left: 1em;
	}
	ol.algorithm ol.algorithm {
	 border-left: none;
	 margin-left: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

	/* Style for paragraphs I know are in MD-genned lists */
	[data-md] > :first-child {
		margin-top: 0;
	}
	[data-md] > :last-child {
		margin-bottom: 0;
	}

/** Inline Lists **************************************************************/
	/* This is mostly to make the list inside the CR exit criteria more compact. */

	ol.inline, ol.inline li {
		display: inline;
		padding: 0; margin: 0;
	}
	ol.inline {
		counter-reset: list-item;
	}
	ol.inline li {
		counter-increment: list-item;
	}
	ol.inline li::before {
		content: "(" counter(list-item) ") ";
		font-weight: bold;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
		font-size: .9em;
		page-break-inside: avoid;
	}
	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Syntax-Highlighted Code ***************************************************/

	.example pre[class*="language-"],
	.example [class*="language-"] pre,
	.example pre[class*="lang-"],
	.example [class*="lang-"] pre {
		background: transparent; /* Prism applies a gray background that doesn't work well in the template. */
	}

/** Example Code **************************************************************/

	div.html, div.xml,
	pre.html, pre.xml {
		padding: 0.5em;
		margin: 1em 0;
		position: relative;
		clear: both;
		color: #600;
	}
	pre.example,
	pre.html,
	pre.xml {
		padding-top: 1.5em;
	}

	pre.illegal, .illegal pre
	pre.deprecated, .deprecated pre {
		color: red;
	}

/** IDL fragments *************************************************************/

	pre.idl {
		/* Match blue propdef boxes */
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}
	pre.idl :link, pre.idl :visited {
		color:inherit;
		background:transparent;
	}

/** Inline CSS fragments ******************************************************/

	.css.css, .property.property, .descriptor.descriptor {
		color: #005a9c;
		font-size: inherit;
		font-family: inherit;
	}
	.css::before, .property::before, .descriptor::before {
		content: "‘";
	}
	.css::after, .property::after, .descriptor::after {
		content: "’";
	}
	.property, .descriptor {
		/* Don't wrap property and descriptor names */
		white-space: nowrap;
	}
	.type { /* CSS value <type> */
	font-style: italic;
	}
	pre .property::before, pre .property::after {
		content: "";
	}

/** Inline markup fragments ***************************************************/

	code.html, code.xml {
		color: #660000;
	}

/** Autolinks produced using Bikeshed *****************************************/

	[data-link-type="property"]::before,
	[data-link-type="propdesc"]::before,
	[data-link-type="descriptor"]::before,
	[data-link-type="value"]::before,
	[data-link-type="function"]::before,
	[data-link-type="at-rule"]::before,
	[data-link-type="selector"]::before,
	[data-link-type="maybe"]::before {
		content: "‘";
	}
	[data-link-type="property"]::after,
	[data-link-type="propdesc"]::after,
	[data-link-type="descriptor"]::after,
	[data-link-type="value"]::after,
	[data-link-type="function"]::after,
	[data-link-type="at-rule"]::after,
	[data-link-type="selector"]::after,
	[data-link-type="maybe"]::after {
		content: "’";
	}

	[data-link-type].production::before,
	[data-link-type].production::after,
	.prod [data-link-type]::before,
	.prod [data-link-type]::after {
		content: "";
	}

	[data-link-type=element]         { font-family: monospace; }
	[data-link-type=element]::before { content: "<" }
	[data-link-type=element]::after  { content: ">" }

	[data-link-type=biblio] {
		white-space: pre;
	}


/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a:link, a:visited {
		color: inherit;
		text-decoration: none;
		border-bottom: 1px solid silver;
	}
	@supports (text-decoration-color: silver) {
		a:link, a:visited {
			border-bottom: none;
			text-decoration: underline;
			text-decoration-color: silver;
		}
		a:visited {
			text-decoration-style: dotted;
		}
	}

	a.logo:link, a.logo:visited { /* backout above styling for W3C logo */
		padding: 0;
		border: none;
		text-decoration: none;
	}

/** Self-Links ****************************************************************/
	/* Auto-generated links from an element to its own anchor, for usability */

	.heading, .issue, .note, .example, li, dt {
		position: relative;
	}
	a.self-link {
		position: absolute;
		top: 0;
		left: -2.5em;
		width: 2em;
		height: 2em;
		text-align: center;
		border: none;
		transition: opacity .2s;
		opacity: .5;
	}
	a.self-link:hover {
		opacity: 1;
	}
	.heading > a.self-link {
		font-size: 83%;
	}
	li > a.self-link {
		left: -3.5em;
	}
	dfn > a.self-link {
		top: auto;
		left: auto;
		opacity: 0;
		width: 1.5em;
		height: 1.5em;
		background: gray;
		color: white;
		font-style: normal;
		transition: opacity .2s, background-color .2s, color .2s;
	}
	dfn:hover > a.self-link {
		opacity: 1;
	}
	dfn > a.self-link:hover {
		color: black;
	}

	a.self-link::before            { content: "¶"; }
	.heading > a.self-link::before { content: "§"; }
	dfn > a.self-link::before      { content: "#"; }

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	figure, div.figure, div.sidefigure {
		page-break-inside: avoid;
	}

	div.figure, p.figure, div.sidefigure, figure {
		text-align: center;
		margin: 2.5em 0;
	}
	div.figure pre, div.sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	div.sidefigure, figure.sidefigure {
		float: right;
		width: 50%;
		margin: 0 0 0.5em 0.5em
	}
	div.figure img, div.sidefigure img, figure img,
	div.figure object, div.sidefigure object, figure object {
		display: block;
		margin: auto;
		max-width: 100%
	}
	p.caption, figcaption, caption {
		text-align: center;
		font-style: italic;
		font-size: 90%;
	}
	p.caption:not(.no-marker)::before, figcaption:not(.no-marker)::before {
		content: "Figure " counter(figure) ". ";
	}
	p.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	p.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > div.figure, dd > figure { margin-left: -2em }

	pre.ascii-art {
		display: table; /* shrinkwrap */
		margin: 1em auto;
	}

	/* Displaying the output of text layout, particularly when
		 line-breaking is being invoked, and thus having a
		 visible width is good. */
	pre.output {
		margin: 1em;
		border: solid thin silver;
		padding: 0.25em;
		display: table;
	}

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .why, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	div.issue,
	div.note,
	div.example,
	details.why,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/
	/* not intended for CR+ publication */

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue:not(.no-marker)::before {
		content: "ISSUE " counter(issue);
		padding-right: 1em;
	}
	.issue::before, .issue > .marker {
		color: #AE1E1E;
	}

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: exampleno;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #827017;
		font-family: sans-serif;
		min-width: 7.5em;
		display: block;
	}
	.example:not(.no-marker)::before {
		content: "EXAMPLE";
		content: "EXAMPLE " counter(exampleno);
	}
	.invalid.example::before, .invalid.example > .marker,
	.illegal.example::before, .illegal.example > .marker {
		color: red;
	}
	.invalid.example:not(.no-marker)::before,
	.illegal.example:not(.no-marker)::before {
		content: "INVALID EXAMPLE";
		content: "INVALID EXAMPLE" counter(exampleno);
	}

/** Non-normative Note ********************************************************/

	.note, .why {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}
	.note::before, .note > .marker {
		display: block;
		color: hsl(120, 70%, 30%);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
		text-align: center;
	}
	strong.advisement {
		display: block;
	}
	/*.advisement::before { color: #FF8800; } */

/** ??? ***********************************************************************/

	details.why {
		border-color: #52E052;
		background: #E9FBE9;
		display: block;
	}

	details.why > summary {
		font-style: italic;
		display: block;
	}

	details.why[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details.annoying-warning {
		display: block;
	}

	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
		border: thick solid red;
		border-radius: 1em;
	}
@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

/** Property/Descriptor Definition Tables *************************************/

	table.propdef, table.propdef-extra,
	table.descdef, table.definition-table {
		page-break-inside: avoid;
		width: 100%;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
		padding: 0.5em 1em;
		background: #DEF;
		border-spacing: 0;
	}

	table.propdef td, table.propdef-extra td,
	table.descdef td, table.definition-table td,
	table.propdef th, table.propdef-extra th,
	table.descdef th, table.definition-table th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}
	table.propdef > tbody > tr:last-child th,
	table.propdef-extra > tbody > tr:last-child th,
	table.descdef > tbody > tr:last-child th,
	table.definition-table > tbody > tr:last-child th,
	table.propdef > tbody > tr:last-child td,
	table.propdef-extra > tbody > tr:last-child td,
	table.descdef > tbody > tr:last-child td,
	table.definition-table > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.propdef th,
	table.propdef-extra th,
	table.descdef th,
	table.definition-table th {
		font-style: italic;
		font-weight: normal;
		width: 8.3em;
		padding-left: 1em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a propdef */
	table.propdef td.footnote,
	table.propdef-extra td.footnote,
	table.descdef td.footnote,
	table.definition-table td.footnote {
		padding-top: 0.6em;
	}
	table.propdef td.footnote::before,
	table.propdef-extra td.footnote::before,
	table.descdef td.footnote::before,
	table.definition-table td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Profile Tables ************************************************************/
	/* table of required features in a CSS profile */

	table.features th {
		background: #00589f;
		color: #fff;
		text-align: left;
		padding: 0.2em 0.2em 0.2em 0.5em;
	}
	table.features td {
		vertical-align: top;
		border-bottom: 1px solid #ccc;
		padding: 0.3em 0.3em 0.3em 0.7em;
	}

/** Data tables (and properly marked-up proptables) ***************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
	*/

	.data, .proptable {
		margin: 1em auto;
		border-collapse: collapse;
		width: 100%;
		border: hidden;
	}
	.data {
		text-align: center;
		width: auto;
	}
	.data caption {
		width: 100%;
	}

	.data td, .data th,
	.proptable td, .proptable th {
		padding: 0.5em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	.data thead td:empty {
		padding: 0;
		border: 0;
	}

	.data thead th[scope="row"],
	.proptable thead th[scope="row"] {
		text-align: right;
		color: inherit;
	}

	.data thead,
	.proptable thead,
	.data tbody,
	.proptable tbody {
		color: inherit;
		border-bottom: 2px solid;
	}

	.data colgroup {
		border-left: 2px solid;
	}

	.data tbody th:first-child,
	.proptable tbody th:first-child ,
	.data tbody td[scope="row"]:first-child,
	.proptable tbody td[scope="row"]:first-child {
		text-align: right;
		color: inherit;
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}
	.data.define td:last-child {
		text-align: left;
	}

	.data tbody th[rowspan],
	.proptable tbody th[rowspan],
	.data tbody td[rowspan],
	.proptable tbody td[rowspan]{
		border-left:  1px solid silver;
		border-right: 1px solid silver;
	}

	.complex.data th,
	.complex.data td {
		border: 1px solid silver;
	}

	.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	.data img {
		vertical-align: middle;
	}


/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	/* ToC not indented, but font style shows hierarchy */
	ul.toc           { margin: 1em 0;     font-weight: bold; /*text-transform: uppercase;*/ }
	ul.toc ul        { margin: 0;        font-weight: normal; text-transform: none; }
	ul.toc ul ul     { margin: 0 0 0 2em; font-style: italic; }
	ul.toc ul ul ul  { margin: 0; }
	ul.toc > li      { margin: 1.5em 0; }
	ul.toc ul.toc li { margin: 0.3em 0 0 0; }

	ul.toc, ul.toc ul, ul.toc li { padding: 0; line-height: 1.3; }
	ul.toc a { text-decoration: none; border-bottom-style: none; }
	ul.toc a:hover, ul.toc a:focus  { border-bottom-style: solid; }
	@supports (text-decoration-style: solid) {
		ul.toc a:hover, ul.toc a:focus  {
			border-bottom-style: none;
			text-decoration-style: solid;
		}
	}
	/*
	ul.toc li li li, ul.toc li li li ul {margin-left: 0; display: inline}
	ul.toc li li li ul, ul.toc li li li ul li {margin-left: 0; display: inline}
	*/

	/* Section numbers in a column of their own */
	ul.toc {
		margin-left: 5em
	}
	ul.toc span.secno {
		float: left;
		width: 4em;
		margin-left: -5em;
	}
	ul.toc ul ul span.secno {
		margin-left: -7em;
	}
	/*ul.toc span.secno {text-align: right}*/
	ul.toc li {
		clear: both;
	}
	/* If we had 'tab', floats would not be needed here:
		 ul.toc span.secno {tab: 5em right; margin-right: 1em}
		 ul.toc li {text-indent: 5em hanging}
	 The second line in case items wrap
	*/

/** At-risk List **************************************************************/
	/* Style for At Risk features (intended as editorial aid, not intended for publishing) */

	.atrisk::before {
	 float: right;
	 margin-top: -0.25em;
	 padding: 0.5em 1em 0.5em 0;
	 text-indent: -0.9em;
	 border: 1px solid;
	 content: '\25C0    Not yet widely implemented';
	 white-space: pre;
	 font-size: small;
	 background-color: white;
	 color: gray;
	 text-align: center;
	}

	.toc .atrisk::before { content:none }

/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.indexlist       { margin-left: 0; columns: 15em; -webkit-columns: 15em; text-indent: 1em hanging; }
	ul.indexlist li    { margin-left: 0; list-style: none; break-inside: avoid; word-break: break-word; }
	ul.indexlist li li { margin-left: 1em }
	ul.indexlist dl    { margin-top: 0; }
	ul.indexlist dt    { margin: .2em 0 .2em 20px;}
	ul.indexlist dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.indexlist ul,
	ul.indexlist dl { font-size: smaller; }
	ul.indexlist li span {
		white-space: nowrap;
		position: absolute;
		color: transparent; }
	ul.indexlist li a:hover + span,
	ul.indexlist li a:focus + span {
		color: gray;
	}
	@media print {
		ul.indexlist li span { color: gray; }
	}

/** Property Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.proptable {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.proptable td,
	table.proptable th {
		padding: 0.4em;
		text-align: center;
	}

	table.proptable tr:hover td {
		background: #DEF;
	}
	.propdef th {
		font-style: italic;
		font-weight: normal;
		text-align: left;
		width: 3em;
	}
	/* The link in the first column in the property table (formerly a TD) */
	table.proptable td .property,
	table.proptable th .property {
		display: block;
		text-align: left;
		font-weight: bold;
	}

/** Extra-large Elements ******************************************************/

	.big-element-wrapper {
		max-width: 50em;
		overflow-x: auto;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		html {
			margin: 0 !important; }
		body {
			font-family: serif; }
		th, td {
			font-family: inherit; }
		a {
			color: inherit !important; }

		a:link, a:visited {
			text-decoration: none !important }
		a:link::after, a:visited::after { /* create a cross-ref "see..." */ }
		.example::before {
			font-family: serif !important; }
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

</style>
  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">HSTS Priming</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">A Collection of Interesting Ideas, <time class="dt-updated" datetime="2015-11-07">7 November 2015</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webappsec-hsts-priming/">https://w3c.github.io/webappsec-hsts-priming/</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Richard Barnes</span> (<span class="p-org org">Mozilla</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" src="https://licensebuttons.net/p/zero/1.0/80x15.png"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 7 November 2015,
the editors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This document proposes modifications to Strict Transport Security’s behavior

in order to mitigate the risk that mixed content blocking will prevent
migrations from HTTP to HTTPS.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#examples"><span class="secno">1.1</span> <span class="content">Example</span></a>
      <li><a href="#goals"><span class="secno">1.2</span> <span class="content">Goals</span></a>
     </ul>
    <li>
     <a href="#modifications"><span class="secno">2</span> <span class="content">Proposed Modifications</span></a>
     <ul class="toc">
      <li>
       <a href="#modifications-fetch"><span class="secno">2.1</span> <span class="content">Fetch</span></a>
       <ul class="toc">
        <li><a href="#modifications-fetch-main"><span class="secno">2.1.1</span> <span class="content">Main Fetch Modifications</span></a>
        <li><a href="#modifications-fetch-network"><span class="secno">2.1.2</span> <span class="content">HTTP-network Fetch modifications</span></a>
        <li><a href="#modifications-fetch-priming"><span class="secno">2.1.3</span> <span class="content">HSTS Priming Requests</span></a>
        <li><a href="#modifications-fetch-hsts-cache"><span class="secno">2.1.4</span> <span class="content">HSTS Cache</span></a>
        <li><a href="#modifications-fetch-hsts-cache-matching"><span class="secno">2.1.5</span> <span class="content"> Does <var>request</var> match the HSTS cache? </span></a>
       </ul>
      <li><a href="#modifications-mixed-content"><span class="secno">2.2</span> <span class="content">Mixed Content</span></a>
      <li><a href="#modifications-hsts"><span class="secno">2.3</span> <span class="content">RFC 6797</span></a>
     </ul>
    <li><a href="#open-questions"><span class="secno">3</span> <span class="content">Open Questions</span></a>
    <li><a href="#security-considerations"><span class="secno">4</span> <span class="content">Security Considerations</span></a>
    <li>
     <a href="#privacy-considerations"><span class="secno">5</span> <span class="content">Privacy Considerations</span></a>
     <ul class="toc">
      <li><a href="#divergent-hosts"><span class="secno">5.1</span> <span class="content">Leakage via Divergent Hosts</span></a>
      <li><a href="#history"><span class="secno">5.2</span> <span class="content">History Leakage</span></a>
     </ul>
    <li><a href="#acknowledgements"><span class="secno">6</span> <span class="content">Acknowledgements</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul>
  </div>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>Migrating sites onto HTTPS is difficult. It has been our common understanding
  that these difficulties were wrapped up in server configuration, performance,
  and certificate maintenance. It’s recently become clear that the true
  challenges lie elsewhere. In particular, opting into secure transport comes
  with a number of restrictions which ensure that "secure" really means
  something. Mixed Content in particular can block an upgrade entirely. Brad
  Hill has laid out an excellent explanation of the challenges that mixed
  content blocking presents, and pointed out a number of situations in which
  cross-dependencies between insecure Origin A and Origin B might cause real
  deadlock where no one is able to upgrade without breakage. His
  "Why isn’t HTTPS everywhere yet?" document <a data-link-type="biblio" href="#biblio-transitional">[TRANSITIONAL]</a> explains the
  situation quite well, and proposes one approach to solving the problem. This
  document proposes another, which is smaller but simpler.</p>
    <p>Today, the mechanism outlined in <a data-link-type="biblio" href="#biblio-upgrade-insecure-requests">[UPGRADE-INSECURE-REQUESTS]</a> allows a site
  to make assertions on behalf of the resources it loads that they ought to be
  requested over secure transport. If we provide a similar mechanism to those
  resources' owners, then that new mechanism could be used to break deadlocks by
  allowing Origin B to upgrade to HTTPS, and assert that requests from Origin A
  should be upgraded rather than blocked as mixed content. <a data-link-type="biblio" href="#biblio-rfc6797">[RFC6797]</a> introduced the <code>Strict-Transport-Security</code> header, which looks like it could
  be that mechanism.</p>
    <p>HSTS, however, is currently checked after mixed content blocking has already
  happened. This is due to the fundamental property that HSTS takes effect only
  after a user’s agent has requested a resource from a host that sends the
  header. The effect is therefore determined by the vagaries of a
  particular user’s browsing history. If she visits Origin B before Origin A,
  then Origin A’s resources could be upgraded without issue. If she visits
  Origin A first, then those resources won’t be upgraded, and the site will
  break in some interesting way.</p>
    <p>Origin A’s developer, of course, is overwhelmingly likely to have visited
  Origin B, given the dependencies. This means that they are both extremely
  unlikely to experience the failure, and extremely likely to fall into the
  "Works on my machine!" trap when dealing with user’s bug reports. Users
  would be sad, developers would be confused, and the world would collapse into
  an unfortunately indeterminate pile of partially broken sites.</p>
    <p>It doesn’t have to be this way, however. This document proposes updates to <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>, <a data-link-type="biblio" href="#biblio-mixed-content">[MIXED-CONTENT]</a>, and <a data-link-type="biblio" href="#biblio-rfc6797">[RFC6797]</a> which introduce the concept of
  an HSTS priming request. This request will attempt to validate an insecure
  resource’s host’s HSTS policy before blocking it as mixed content, therefore
  allowing any relevant upgrade from HTTP to HTTPS to be made in a deterministic
  way for all users.</p>
    <p>This is not a recommendation-track document, it simply intends to explain the
  notion of HSTS priming, and gather up relevant changes in a single place for
  discussion. The normative changes will happen in the relevant documents.</p>
    <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Example</span><a class="self-link" href="#examples"></a></h3>
    <p>Origin A contains the following HTML:</p>
<pre>&lt;script src="http://origin-b/widget.js">&lt;/script>
</pre>
    <p>Before blocking this insecure request as mixed content, the user agent
  checks whether the request <a data-link-type="dfn" href="#matches-the-hsts-cache">matches its HSTS
  cache</a>.</p>
    <p>If the resource did not match the HSTS cache, the user agent performs an HSTS
  priming request over HTTPS to the root of the resource’s host, as follows:</p>
<pre>HEAD / HTTP/1.1
Host: origin-b
...
</pre>
    <p>Origin B sends back a response which triggers HSTS for the host:</p>
<pre>HTTP/1.1 200 OK
...
Strict-Transport-Security: max-age=10886400; includeSubDomains
</pre>
    <p>The user agent can then safely upgrade the initial request from HTTP to HTTPS,
  rather than blocking it as mixed content.</p>
    <h3 class="heading settled" data-level="1.2" id="goals"><span class="secno">1.2. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
    <p>HSTS priming has the overarching goal of removing mixed content as a barrier
  to securing the internet. This breaks down into two concrete objectives:</p>
    <ol>
     <li data-md="">
      <p>Convert the <code>Strict-Transport-Security</code> assertion from a negative one
  ("This host is only available via secure transport") to a positive one
  ("Any resource on this host addressed by an insecure scheme is available
  via secure transport. Please grab it from there instead.").</p>
     <li data-md="">
      <p>Teach user agents how to verify this new HSTS assertion early enough in a
  request’s lifecycle to avoid being blocked as mixed content.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="modifications"><span class="secno">2. </span><span class="content">Proposed Modifications</span><a class="self-link" href="#modifications"></a></h2>
    <h3 class="heading settled" data-level="2.1" id="modifications-fetch"><span class="secno">2.1. </span><span class="content">Fetch</span><a class="self-link" href="#modifications-fetch"></a></h3>
    <h4 class="heading settled" data-level="2.1.1" id="modifications-fetch-main"><span class="secno">2.1.1. </span><span class="content">Main Fetch Modifications</span><a class="self-link" href="#modifications-fetch-main"></a></h4>
    <ol>
     <li data-md="">
      <p>After the current step 3 (which deals with <code>Upgrade-Insecure-Requests</code>),
  add the following steps:</p>
      <ol>
       <li data-md="">
        <p>If <var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-client">client</a> <a data-link-type="dfn" href="https://w3c.github.io/webappsec-mixed-content/#categorize-settings-object">prohibits mixed security
  contexts</a>, and <var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-current-url">current url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a> is "<code>http</code>" or "<code>ws</code>", and it isn’t a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#navigation-request">navigation request</a>, and its <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a> does not <a data-link-type="dfn" href="#matches-the-hsts-cache">match the HSTS cache</a>, then
  perform an <a data-link-type="dfn" href="#hsts-priming-request">HSTS priming request</a> for <var>request</var>.</p>
      </ol>
     <li data-md="">
      <p>Move the current step 6 (which deals with HSTS) before the current step 4
  (which deals with CSP and mixed content).</p>
      <p class="note" role="note">Note: This isn’t entirely accurate, as we probably want reporting to
  happen before the upgrade (that is, before the current step 3). That’s
  a bug in the existing algorithm that I need to take care of.</p>
      <p class="note" role="note">Note: Maybe use the newly defined <a data-link-type="dfn" href="#hsts-cache">HSTS cache</a> for the upgrade
  instead of deferring to the RFC.</p>
    </ol>
    <p class="note" role="note">Note: If a user agent implements prerendering or prefetching, it might be a
  wonderful idea to perform a priming request for any insecure navigation that
  such a function proposes. The performance impact would be (mostly) hidden by
  the background nature of such a request, and the security impacts would be
  interesting indeed.</p>
    <h4 class="heading settled" data-level="2.1.2" id="modifications-fetch-network"><span class="secno">2.1.2. </span><span class="content">HTTP-network Fetch modifications</span><a class="self-link" href="#modifications-fetch-network"></a></h4>
    <p>Modify <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#http-network-fetch">HTTP-network Fetch</a> as follows:</p>
    <ol>
     <li data-md="">
      <p>After the current step 9 (which processes the <code>Set-Cookie</code> header),
  execute the following steps:</p>
      <ol>
       <li data-md="">
        <p>If <var>response</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-header-list">header list</a> contains one or more headers
  named <code>Strict-Transport-Security</code>, then add an entry to the <a data-link-type="dfn" href="#hsts-cache">HSTS
  cache</a> with the following properties:</p>
        <dl>
         <dt data-md="">
          <p><a data-link-type="dfn" href="#host">host</a></p>
         <dd data-md="">
          <p><var>response</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-url">url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="#expiration">expiration</a></p>
         <dd data-md="">
          <p class="issue" id="issue-ad95c933"><a class="self-link" href="#issue-ad95c933"></a> Parse the header.</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="#subdomains">subdomains</a></p>
         <dd data-md="">
          <p class="issue" id="issue-ad95c9330"><a class="self-link" href="#issue-ad95c9330"></a> Parse the header.</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="#status">status</a></p>
         <dd data-md="">
          <p>"<code>upgrade</code>"</p>
        </dl>
      </ol>
    </ol>
    <h4 class="heading settled" data-level="2.1.3" id="modifications-fetch-priming"><span class="secno">2.1.3. </span><span class="content">HSTS Priming Requests</span><a class="self-link" href="#modifications-fetch-priming"></a></h4>
    <p>To perform an <dfn data-dfn-type="dfn" data-noexport="" id="hsts-priming-request">HSTS Priming Request<a class="self-link" href="#hsts-priming-request"></a></dfn> for <var>request</var>, run these steps:</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-current-url">current url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a> is not "<code>http</code>" or "<code>ws</code>", abort these steps.</p>
      <p class="note" role="note">Note: I’m assuming that Web Sockets are going to be folded into Fetch at
  some point?</p>
     <li data-md="">
      <p>Let <var>primer</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request">request</a> whose properties are set as follows:</p>
      <dl>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-method">method</a></p>
       <dd data-md="">
        <p>"<code>HEAD</code>"</p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-url">url</a></p>
       <dd data-md="">
        <p>A new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-url">URL</a> whose scheme is "<code>https</code>", <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a> is <var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-current-url">current url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a>,
  and <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-port">port</a> is <var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-current-url">current
  url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-port">port</a></p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-initiator">initiator</a></p>
       <dd data-md="">
        <p><var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-initiator">initiator</a></p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-type">type</a></p>
       <dd data-md="">
        <p><var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-type">type</a></p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-destination">destination</a></p>
       <dd data-md="">
        <p><var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-destination">destination</a></p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-credentials-mode">credentials mode</a></p>
       <dd data-md="">
        <p><var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-credentials-mode">credentials mode</a></p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-redirect-mode">redirect mode</a></p>
       <dd data-md="">
        <p>"<code>manual</code>"</p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-client">client</a></p>
       <dt data-md="">
        <p><code>null</code></p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-referrer-policy">referrer policy</a></p>
       <dd data-md="">
        <p>"<code>no-referrer</code>"</p>
      </dl>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-append">Append</a> a header named "<code>Upgrade-Insecure-Requests</code>" with a value of
  "<code>1</code>" to <var>primer</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-header-list">header list</a>.</p>
     <li data-md="">
      <p>Let <var>response</var> be the result of performing an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#http-network-or-cache-fetch">HTTP-network-or-cache
  fetch</a> using <var>primer</var>.</p>
     <li data-md="">
      <p>If <var>response</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-header-list">header list</a> does not contain one or more headers
  named <code>Strict-Transport-Security</code>, then add an entry to the <a data-link-type="dfn" href="#hsts-cache">HSTS
  cache</a> with the following properties:</p>
      <dl>
       <dt data-md="">
        <p><a data-link-type="dfn" href="#host">host</a></p>
       <dd data-md="">
        <p><var>primer</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-url">url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a></p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="#expiration">expiration</a></p>
       <dd data-md="">
        <p>A reasonable expiration. Perhaps 24 hours?</p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="#subdomains">subdomains</a></p>
       <dd data-md="">
        <p>"<code>exclude</code>"</p>
       <dt data-md="">
        <p><a data-link-type="dfn" href="#status">status</a></p>
       <dd data-md="">
        <p>"<code>do not upgrade</code>"</p>
      </dl>
    </ol>
    <h4 class="heading settled" data-level="2.1.4" id="modifications-fetch-hsts-cache"><span class="secno">2.1.4. </span><span class="content">HSTS Cache</span><a class="self-link" href="#modifications-fetch-hsts-cache"></a></h4>
    <p>An <dfn data-dfn-type="dfn" data-noexport="" id="hsts-cache">HSTS cache<a class="self-link" href="#hsts-cache"></a></dfn> consists of a collection of <dfn data-dfn-type="dfn" data-noexport="" id="hsts-cache-entry">HSTS cache
  entry<a class="self-link" href="#hsts-cache-entry"></a></dfn> objects, each with the following properties:</p>
    <dl>
     <dt data-md="">
      <p><dfn data-dfn-for="HSTS cache entry" data-dfn-type="dfn" data-noexport="" id="host">host<a class="self-link" href="#host"></a></dfn></p>
     <dd data-md="">
      <p>A <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a></p>
     <dt data-md="">
      <p><dfn data-dfn-for="HSTS cache entry" data-dfn-type="dfn" data-noexport="" id="expiration">expiration<a class="self-link" href="#expiration"></a></dfn></p>
     <dd data-md="">
      <p>A timestamp, after which this entry is no longer valid</p>
     <dt data-md="">
      <p><dfn data-dfn-for="HSTS cache entry" data-dfn-type="dfn" data-noexport="" id="subdomains">subdomains<a class="self-link" href="#subdomains"></a></dfn></p>
     <dd data-md="">
      <p>"<code>include</code>" or "<code>exclude</code>"</p>
     <dt data-md="">
      <p><dfn data-dfn-for="HSTS cache entry" data-dfn-type="dfn" data-noexport="" id="status">status<a class="self-link" href="#status"></a></dfn></p>
     <dd data-md="">
      <p>"<code>upgrade</code>" or "<code>do not upgrade</code>"</p>
    </dl>
    <h4 class="heading settled" data-algorithm="Does request match the HSTS cache?" data-level="2.1.5" id="modifications-fetch-hsts-cache-matching"><span class="secno">2.1.5. </span><span class="content"> Does <var>request</var> match the HSTS cache? </span><a class="self-link" href="#modifications-fetch-hsts-cache-matching"></a></h4>
     A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request">request</a> (<var>request</var>) <dfn data-dfn-type="dfn" data-noexport="" id="matches-the-hsts-cache">matches the HSTS cache<a class="self-link" href="#matches-the-hsts-cache"></a></dfn> if there exists
  an <a data-link-type="dfn" href="#hsts-cache-entry">HSTS cache entry</a> <var>entry</var> in the user agent’s <a data-link-type="dfn" href="#hsts-cache">HSTS cache</a> such
  that: 
    <ol>
     <li data-md="">
      <p>The current time is not after <var>entry</var>'s <a data-link-type="dfn" href="#expiration">expiration</a></p>
     <li data-md="">
      <p><var>entry</var>'s <a data-link-type="dfn" href="#host">host</a> is a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6797#section-8.2">concurrent match</a> for <var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-current-url">current url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a></p>
      <p>or</p>
      <p><var>entry</var>'s <a data-link-type="dfn" href="#subdomains">subdomains</a> is "<code>include</code>", and <var>entry</var>'s <a data-link-type="dfn" href="#host">host</a> is a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6797#section-8.2">superdomain match</a> for <var>request</var>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-request-current-url">current url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host">host</a></p>
    </ol>
    <h3 class="heading settled" data-level="2.2" id="modifications-mixed-content"><span class="secno">2.2. </span><span class="content">Mixed Content</span><a class="self-link" href="#modifications-mixed-content"></a></h3>
    <ol>
     <li data-md="">
      <p>Explain the nature of the relationship to HSTS.</p>
    </ol>
    <h3 class="heading settled" data-level="2.3" id="modifications-hsts"><span class="secno">2.3. </span><span class="content">RFC 6797</span><a class="self-link" href="#modifications-hsts"></a></h3>
    <ol>
     <li data-md="">
      <p>Explain the nature of the new assertion that’s being made, and its
  implications.</p>
     <li data-md="">
      <p>Integrate the spec with Fetch.</p>
    </ol>
    <p class="issue" id="issue-1ddc8e85"><a class="self-link" href="#issue-1ddc8e85"></a> Lots more specifics everywhere.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="open-questions"><span class="secno">3. </span><span class="content">Open Questions</span><a class="self-link" href="#open-questions"></a></h2>
    <ol>
     <li data-md="">
      <p>Would it be valuable enough to do this for navigational requests as well?
  That would have the impact of making the initial window for attack
  marginally smaller (e.g. the attacker would have to actively block
  connections over 443, rather than executing an ssl stripping attack), but
  it’s not clear that there’s much value in the additional complexity.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="security-considerations"><span class="secno">4. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
    <p>HSTS priming makes it more likely that developers can upgrade their sites from
  HTTP to HTTPS, as discussed in the introduction.</p>
    <p>It has the nice side-effect of making it possible for CDNs and widget
  providers to increase the security of the web in one fell swoop, which
  increases the value of the <code>Strict-Transport-Security</code> header significantly.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="privacy-considerations"><span class="secno">5. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy-considerations"></a></h2>
    <h3 class="heading settled" data-level="5.1" id="divergent-hosts"><span class="secno">5.1. </span><span class="content">Leakage via Divergent Hosts</span><a class="self-link" href="#divergent-hosts"></a></h3>
    <p>As little sense as it may make, some hosts do serve different content via
  HTTPS than they serve via HTTP (<code>forbes.com</code> is the canonical example). HSTS
  priming has the potential of leaking information about insecure resource
  requests to the secure variant of the requests' host. We mitigate this risk
  by stripping out interesting information from the priming request. It does
  not contain referrer information (as we set the referrer policy to <code>none</code>), it
  contains no credential information, and it doesn’t contain the URL of the
  resource being requested (as we target the root of the secure origin).</p>
    <h3 class="heading settled" data-level="5.2" id="history"><span class="secno">5.2. </span><span class="content">History Leakage</span><a class="self-link" href="#history"></a></h3>
    <p>The HSTS state of a host leaks some information about a user’s browsing
  history. Likewise, if the user agent caches failed HSTS priming requests,
  those failures leak information. User agents SHOULD give users the ability
  to clear these caches, and should expire them in a reasonable amount of time.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="acknowledgements"><span class="secno">6. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>Richard Barnes <a href="https://lists.w3.org/Archives/Public/public-webappsec/2015Aug/0095.html">proposed this treatment</a> in a thread that included very helpful comments from Eric Mill, Brad Hill,
  Mark Nottingham, Brian Smith, Tanvi Vyas, Martin Thomson, and Anne van
  Kesteren.</p>
   </section>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
        The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
        in the normative parts of this document
        are to be interpreted as described in RFC 2119.
        However, for readability,
        these words do not appear in all uppercase letters in this specification. </p>
  <p> All of the text of this specification is normative
        except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
  <p> Examples in this specification are introduced with the words “for example”
        or are set apart from the normative text with <code>class="example"</code>, like this: </p>
  <div class="example" id="example-ae2b6bc0"><a class="self-link" href="#example-ae2b6bc0"></a> This is an example of an informative example. </div>
  <p> Informative notes begin with the word “Note”
        and are set apart from the normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note"> Note, this is an informative note. </p>
  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li><a href="#expiration">expiration</a><span>, in §2.1.4</span>
   <li><a href="#host">host</a><span>, in §2.1.4</span>
   <li><a href="#hsts-cache">HSTS cache</a><span>, in §2.1.4</span>
   <li><a href="#hsts-cache-entry">HSTS cache
  entry</a><span>, in §2.1.4</span>
   <li><a href="#hsts-priming-request">HSTS Priming Request</a><span>, in §2.1.3</span>
   <li><a href="#matches-the-hsts-cache">matches the HSTS cache</a><span>, in §2.1.5</span>
   <li><a href="#status">status</a><span>, in §2.1.4</span>
   <li><a href="#subdomains">subdomains</a><span>, in §2.1.4</span>
  </ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li>
    <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-client">client</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-credentials-mode">credentials mode</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-current-url">current url</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-destination">destination</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-header-list">header list</a>
     <li><a href="https://fetch.spec.whatwg.org#http-network-fetch">http-network fetch</a>
     <li><a href="https://fetch.spec.whatwg.org#http-network-or-cache-fetch">http-network-or-cache fetch</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-initiator">initiator</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-method">method</a>
     <li><a href="https://fetch.spec.whatwg.org#navigation-request">navigation request</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-redirect-mode">redirect mode</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-referrer-policy">referrer policy</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request">request</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-type">type</a>
     <li><a href="https://fetch.spec.whatwg.org#concept-request-url">url</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-mix">[MIX]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec-mixed-content/#categorize-settings-object">prohibits mixed security contexts</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc6797">[rfc6797]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6797#section-8.2">concurrent match</a>
     <li><a href="https://tools.ietf.org/html/rfc6797#section-8.2">superdomain match</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-dom-ls">[dom-ls]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#concept-node-append">append</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-url">[url]</a> defines the following terms:
    <ul>
     <li><a href="https://url.spec.whatwg.org/#concept-url-host">host</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-port">port</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a>
    </ul>
  </ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-fetch"><a class="self-link" href="#biblio-fetch"></a>[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-mix"><a class="self-link" href="#biblio-mix"></a>[MIX]
   <dd>Mike West. <a href="http://www.w3.org/TR/mixed-content/">Mixed Content</a>. 8 October 2015. CR. URL: <a href="http://www.w3.org/TR/mixed-content/">http://www.w3.org/TR/mixed-content/</a>
   <dt id="biblio-dom-ls"><a class="self-link" href="#biblio-dom-ls"></a>[DOM-LS]
   <dd>Document Object Model URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc6797"><a class="self-link" href="#biblio-rfc6797"></a>[RFC6797]
   <dd>J. Hodges; C. Jackson; A. Barth. <a href="https://tools.ietf.org/html/rfc6797">HTTP Strict Transport Security (HSTS)</a>. November 2012. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6797">https://tools.ietf.org/html/rfc6797</a>
   <dt id="biblio-url"><a class="self-link" href="#biblio-url"></a>[URL]
   <dd>Anne van Kesteren; Sam Ruby. <a href="http://www.w3.org/TR/url-1/">URL</a>. 9 December 2014. WD. URL: <a href="http://www.w3.org/TR/url-1/">http://www.w3.org/TR/url-1/</a>
  </dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-transitional"><a class="self-link" href="#biblio-transitional"></a>[TRANSITIONAL]
   <dd>Brad Hill. <a href="http://webappsec-test.info/~bhill2/DifferentTakeOnOE.html">Why isn't HTTPS everywhere yet?</a>. URL: <a href="http://webappsec-test.info/~bhill2/DifferentTakeOnOE.html">http://webappsec-test.info/~bhill2/DifferentTakeOnOE.html</a>
   <dt id="biblio-mixed-content"><a class="self-link" href="#biblio-mixed-content"></a>[MIXED-CONTENT]
   <dd>Mike West. <a href="http://www.w3.org/TR/mixed-content/">Mixed Content</a>. 8 October 2015. CR. URL: <a href="http://www.w3.org/TR/mixed-content/">http://www.w3.org/TR/mixed-content/</a>
   <dt id="biblio-upgrade-insecure-requests"><a class="self-link" href="#biblio-upgrade-insecure-requests"></a>[UPGRADE-INSECURE-REQUESTS]
   <dd>Mike West. <a href="http://www.w3.org/TR/upgrade-insecure-requests/">Upgrade Insecure Requests</a>. 8 October 2015. CR. URL: <a href="http://www.w3.org/TR/upgrade-insecure-requests/">http://www.w3.org/TR/upgrade-insecure-requests/</a>
  </dl>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Parse the header.<a href="#issue-ad95c933"> ↵ </a></div>
   <div class="issue"> Parse the header.<a href="#issue-ad95c9330"> ↵ </a></div>
   <div class="issue"> Lots more specifics everywhere.<a href="#issue-1ddc8e85"> ↵ </a></div>
  </div>
 </body>
</html>